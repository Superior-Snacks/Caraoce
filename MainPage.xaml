<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="Caraoce.MainPage"
             BackgroundColor="#1a1a2e"
             Title="Now Playing"
             NavigationPage.HasNavigationBar="False">

    <Grid>
        <CarouselView x:Name="LyricsCarousel"
                      IndicatorView="indicatorView"
                      VerticalOptions="FillAndExpand"
                      IsSwipeEnabled="False">
            <CarouselView.ItemTemplate>
                <DataTemplate>
                    <Grid Padding="10">
                        <Grid.GestureRecognizers>
                            <TapGestureRecognizer Tapped="OnScreenTapped" />
                        </Grid.GestureRecognizers>

                        <Label Text="{Binding Text}"
                               FontSize="80" 
                               FontAttributes="Bold"
                               TextColor="White"
                               HorizontalOptions="Center"
                               VerticalOptions="Center"
                               HorizontalTextAlignment="Center" 
                               LineBreakMode="WordWrap"/>
                    </Grid>
                </DataTemplate>
            </CarouselView.ItemTemplate>
        </CarouselView>

        <Grid x:Name="UiOverlay"
              Opacity="0"
              InputTransparent="True">

            <Grid.GestureRecognizers>
                <TapGestureRecognizer Tapped="OnScreenTapped" />
            </Grid.GestureRecognizers>

            <Label x:Name="StatusLabel"
                   Text="Song Title"
                   TextColor="White"
                   FontSize="24"
                   FontAttributes="Bold"
                   HorizontalOptions="Center"
                   VerticalOptions="Start"
                   Margin="0,40,0,0">
                <Label.Shadow>
                    <Shadow Brush="Black" Offset="2,2" Radius="5" Opacity="0.8"/>
                </Label.Shadow>
            </Label>

            <VerticalStackLayout VerticalOptions="End" 
                                 Spacing="15" 
                                 Padding="20,0,20,30">

                <VerticalStackLayout.Background>
                    <LinearGradientBrush EndPoint="0,1">
                        <GradientStop Color="Transparent" Offset="0.0" />
                        <GradientStop Color="#cc1a1a2e" Offset="0.3" />
                        <GradientStop Color="#1a1a2e" Offset="1.0" />
                    </LinearGradientBrush>
                </VerticalStackLayout.Background>

                <Button x:Name="PlayPauseButton"
                        Text="⏸"
                        FontSize="40"
                        TextColor="White"
                        BackgroundColor="#e94560"
                        WidthRequest="90"
                        HeightRequest="90"
                        CornerRadius="45"
                        HorizontalOptions="Center"
                        Clicked="OnPlayPauseClicked">
                    <Button.Shadow>
                        <Shadow Brush="Black" Offset="0,4" Radius="8" Opacity="0.5"/>
                    </Button.Shadow>
                </Button>

                <Grid ColumnDefinitions="Auto, *, Auto" Margin="0,10">
                    <Label x:Name="CurrentTimeLabel" Text="0:00" TextColor="#ccc" VerticalOptions="Center"/>

                    <Slider x:Name="PositionSlider"
                            Grid.Column="1"
                            Minimum="0"
                            Maximum="1"
                            ThumbColor="#e94560"
                            MinimumTrackColor="#e94560"
                            MaximumTrackColor="Gray"
                            Margin="15,0"
                            DragCompleted="OnSliderDragCompleted"
                            DragStarted="OnSliderDragStarted"/>

                    <Label x:Name="TotalTimeLabel" Text="0:00" TextColor="#ccc" VerticalOptions="Center" Grid.Column="2"/>
                </Grid>

                <Grid ColumnDefinitions="50, *, 50">
                    <ImageButton Grid.Column="0"
                                 Source="back_icon.png" 
                                 HeightRequest="40" 
                                 WidthRequest="40"
                                 Clicked="OnStopClicked"
                                 BackgroundColor="Transparent"
                                 HorizontalOptions="Start"/>

                    <IndicatorView Grid.Column="1"
                                   x:Name="indicatorView"
                                   IndicatorColor="#555"
                                   SelectedIndicatorColor="#e94560"
                                   HorizontalOptions="Center"
                                   VerticalOptions="Center"/>
                </Grid>
            </VerticalStackLayout>
        </Grid>
    </Grid>
</ContentPage>